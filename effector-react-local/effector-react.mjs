function e(e,t,n){let r={node:[d.run({fn:e=>t(e)})]};if(n){let t=k(r),o=e.graphite.id,u=n.additionalLinks[o]=n.additionalLinks[o]||[];return u.push(t),()=>{let e=u.indexOf(t);-1!==e&&u.splice(e,1),g(t)}}{r.parent=e,r.family={type:'crosslink',owners:e};let t=k(r);return()=>{g(t)}}}function t(e,t){return t.displayName=e,t}function n(t,n){h.store(t)||w('expect useStore argument to be a store');let r=j(t,n),o=E(),u=y.useRef({store:t,value:r,pending:0});return S((()=>{let r=e(t,(e=>{let t=u.current;t.pending||(t.value=e,t.pending=1,o(),t.pending=0)}),n),s=j(t,n),a=u.current;return a.store===t&&a.value!==s&&(a.value=s,a.pending=1,o(),a.pending=0),a.store=t,r}),[t]),r}function r([t,n],r){let u,s,a,l=N;n?(u=n,s=t,a=[]):(u=t.fn,s=t.store,a=t.keys,l=t.updateFilter||N),h.store(s)||w('useStoreMap expects a store'),Array.isArray(a)||w('useStoreMap expects an array as keys'),'function'!=typeof u&&w('useStoreMap expects a function');let i=y.useRef({}),c=i.current;c.fn=u,c.upd=l,c.init=c.store===s,c.store=s;let f=E(),p=y.useMemo((()=>(o(j(s,r),a,i.current),e(s,(e=>o(e,a,i.current,f)),r))),a);return S((()=>()=>p()),a),c.val}function o(e,t,n,r){let o=n.fn(e,t);n.init?void 0!==o&&N(o,n.val)&&n.upd(o,n.val)&&(n.val=o,r&&r()):(n.val=o,n.init=1)}function u(e){return e}function s(e){return n(e)}function a(e,t){return r([e,t])}function l(e,o){return((e,o,u)=>{let s,a,l=[];'object'==typeof o&&null!==o?(o.keys&&(l=o.keys),s=o.fn,o.getKey&&(a=o.getKey)):s=o,h.store(e)||w('expect useList first argument to be a store'),'function'!=typeof s&&w("expect useList's renderItem to be a function"),Array.isArray(l)||w("expect useList's keys to be an array");let i=y.useMemo((()=>{let n=t(`${e.shortName||'Unknown'}.Item`,(t=>{let{index:n,keys:o,keyVal:s,value:a}=t;if(c.current[1])return c.current[0](a,s);let l=r([{store:e,keys:[n,...o],fn:(e,t)=>e[t[0]]}],u);return c.current[0](l,n)}));return y.memo(n)}),[e,!!a]),c=y.useRef([s,a]);c.current=[s,a];let f=y.useMemo((()=>l),l);if(a)return n(e,u).map((e=>{let t=c.current[1](e);return y.createElement(i,{keyVal:t,key:t,keys:f,value:e})}));{let t=r([{store:e,keys:[e],fn:e=>e.length}],u);return Array.from({length:t},((e,t)=>y.createElement(i,{index:t,key:t,keys:f})))}})(e,o)}function i(e,n){function r(e){let t=y.useRef(e),r=s(o);S((()=>(a({props:t.current,state:o.getState()}),()=>{l({props:t.current,state:o.getState()})})),[]);let u=n(e,r);return t.current=e,u}let o;h.store(e)?o=e:'object'==typeof e&&null!==e?o=v(e):w('shape should be a store or object with stores');let u='Unknown';o&&o.shortName&&(u=o.shortName);let a=b(),l=b();return r.mounted=a,r.unmounted=l,t(`${u}.View`,r)}function c(e){return i(e,(({children:e},t)=>e(t)))}function f(e,n){return t(`Connect(${n.displayName||n.name||'Unknown'})`,(t=>y.createElement(n,{...t,...s(e)})))}function p(e,t={}){let n=y.useRef(null);S((()=>(e.open(n.current),()=>e.close(n.current))),[e]),((e,t)=>{if(e===t)return 1;if('object'==typeof e&&null!==e&&'object'==typeof t&&null!==t){let n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return 0;for(let r=0;r<n.length;r++){let o=n[r];if(e[o]!==t[o])return 0}return 1}return 0})(n.current,t)||(n.current=t,e.set(t))}function m(e="gate",n={}){let r;return'object'==typeof e&&null!==e&&('defaultState'in e&&(n=e.defaultState),e.domain&&(r=e.domain),e=e.name),(({name:e="gate",domain:n,defaultState:r,hook:o})=>{function u(e){return o(u,e),null}let s=`${n?`${n.compositeName.fullName}/`:''}${e}`,a=b(`${s}.set`),l=b(`${s}.open`),i=b(`${s}.close`),c=x(Boolean(0),{name:`${s}.status`}).on(l,(()=>Boolean(1))).on(i,(()=>Boolean(0))),f=x(r,{name:`${s}.state`}).on(a,((e,t)=>t)).reset(i);if(n){let{hooks:e}=n;$({target:[e.store,e.store,e.event,e.event,e.event],params:[c,f,l,i,a]})}return u.open=l,u.close=i,u.status=c,u.state=f,u.set=a,t(`Gate:${s}`,u)})({name:e,domain:r,defaultState:n,hook:p})}import y from'react';import{step as d,createNode as k,clearNode as g,is as h,combine as v,createEvent as b,createStore as x,launch as $}from'effector/effector.mjs';let S='undefined'!=typeof window?y.useLayoutEffect:y.useEffect,w=e=>{throw Error(e)};const j=(e,t)=>t?t.getState(e):e.getState(),N=(e,t)=>e!==t,E=()=>y.useReducer((e=>e+1),0)[1];let L=(e,n,r)=>t(`${e.shortName||'Unknown'}.ContextComponent`,(t=>{let o=y.useContext(n),u=s(e);return r(t,u,o)})),M=e=>t=>{let n=e;return'function'!=typeof e&&(n=t,t=e),f(t,n)};export{M as connect,i as createComponent,L as createContextComponent,m as createGate,f as createReactState,c as createStoreConsumer,u as useEvent,p as useGate,l as useList,s as useStore,a as useStoreMap};
//# sourceMappingURL=effector-react.mjs.map
