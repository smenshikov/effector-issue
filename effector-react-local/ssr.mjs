function e(e,t,n){let r={node:[v.run({fn:e=>t(e)})]};if(n){let t=x(r),o=e.graphite.id,u=n.additionalLinks[o]=n.additionalLinks[o]||[];return u.push(t),()=>{let e=u.indexOf(t);-1!==e&&u.splice(e,1),h(t)}}{r.parent=e,r.family={type:'crosslink',owners:e};let t=x(r);return()=>{h(t)}}}function t(e,t){return t.displayName=e,t}function n(t,n){b.store(t)||w('expect useStore argument to be a store');let r=E(t,n),o=N(),u=g.useRef({store:t,value:r,pending:0});return A((()=>{let r=e(t,(e=>{let t=u.current;t.pending||(t.value=e,t.pending=1,o(),t.pending=0)}),n),s=E(t,n),a=u.current;return a.store===t&&a.value!==s&&(a.value=s,a.pending=1,o(),a.pending=0),a.store=t,r}),[t]),r}function r([t,n],r){let u,s,a,l=L;n?(u=n,s=t,a=[]):(u=t.fn,s=t.store,a=t.keys,l=t.updateFilter||L),b.store(s)||w('useStoreMap expects a store'),Array.isArray(a)||w('useStoreMap expects an array as keys'),'function'!=typeof u&&w('useStoreMap expects a function');let i=g.useRef({}),c=i.current;c.fn=u,c.upd=l,c.init=c.store===s,c.store=s;let f=N(),p=g.useMemo((()=>(o(E(s,r),a,i.current),e(s,(e=>o(e,a,i.current,f)),r))),a);return A((()=>()=>p()),a),c.val}function o(e,t,n,r){let o=n.fn(e,t);n.init?void 0!==o&&L(o,n.val)&&n.upd(o,n.val)&&(n.val=o,r&&r()):(n.val=o,n.init=1)}function u(){let e=g.useContext(O);return e||w('No scope found, consider adding <Provider> to app root'),e}function s(e){return e&&b.domain(e.domain)||w('config.domain should exists'),(({name:e="gate",domain:n,defaultState:r,hook:o})=>{function u(e){return o(u,e),null}let s=`${n?`${n.compositeName.fullName}/`:''}${e}`,a=$(`${s}.set`),l=$(`${s}.open`),i=$(`${s}.close`),c=S(Boolean(0),{name:`${s}.status`}).on(l,(()=>Boolean(1))).on(i,(()=>Boolean(0))),f=S(r,{name:`${s}.state`}).on(a,((e,t)=>t)).reset(i);if(n){let{hooks:e}=n;j({target:[e.store,e.store,e.event,e.event,e.event],params:[c,f,l,i,a]})}return u.open=l,u.close=i,u.status=c,u.state=f,u.set=a,t(`Gate:${s}`,u)})({domain:e.domain,name:e.name,defaultState:'defaultState'in e?e.defaultState:{},hook:a})}function a(e,t={}){let[n,r,o]=k([e.open,e.close,e.set]);((e,t={})=>{let n=g.useRef(null);A((()=>(e.open(n.current),()=>e.close(n.current))),[e]),((e,t)=>{if(e===t)return 1;if('object'==typeof e&&null!==e&&'object'==typeof t&&null!==t){let n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return 0;for(let r=0;r<n.length;r++){let o=n[r];if(e[o]!==t[o])return 0}return 1}return 0})(n.current,t)||(n.current=t,e.set(t))})(g.useMemo((()=>({open:n,close:r,set:o})),[e,n]),t)}function l(e){return t=>{let n=d(e);return t.children(n)}}function i(e,t,n){return r=>{let o=g.useContext(t),u=d(e);return n(r,u,o)}}function c(){w('not implemented')}function f(e,n){return t(`Connect(${n.displayName||n.name||'Unknown'})`,(t=>g.createElement(n,{...t,...d(e)})))}function p(e){return t=>f(t,e)}function d(e){return n(e,u())}function m(e,o){return((e,o,u)=>{let s,a,l=[];'object'==typeof o&&null!==o?(o.keys&&(l=o.keys),s=o.fn,o.getKey&&(a=o.getKey)):s=o,b.store(e)||w('expect useList first argument to be a store'),'function'!=typeof s&&w("expect useList's renderItem to be a function"),Array.isArray(l)||w("expect useList's keys to be an array");let i=g.useMemo((()=>{let n=t(`${e.shortName||'Unknown'}.Item`,(t=>{let{index:n,keys:o,keyVal:s,value:a}=t;if(c.current[1])return c.current[0](a,s);let l=r([{store:e,keys:[n,...o],fn:(e,t)=>e[t[0]]}],u);return c.current[0](l,n)}));return g.memo(n)}),[e,!!a]),c=g.useRef([s,a]);c.current=[s,a];let f=g.useMemo((()=>l),l);if(a)return n(e,u).map((e=>{let t=c.current[1](e);return g.createElement(i,{keyVal:t,key:t,keys:f,value:e})}));{let t=r([{store:e,keys:[e],fn:e=>e.length}],u);return Array.from({length:t},((e,t)=>g.createElement(i,{index:t,key:t,keys:f})))}})(e,o,u())}function y(e,t){let n=u();return r(t?[e,t]:[{store:e.store,keys:e.keys,fn:e.fn,updateFilter:e.updateFilter}],n)}function k(e){let t=u(),n=b.unit(e)||'object'!=typeof e?{event:e}:e;return g.useMemo((()=>{if(b.unit(e))return M(e,{scope:t});let n=Array.isArray(e)?[]:{};for(let r in e)n[r]=M(e[r],{scope:t});return n}),[t,...Object.keys(n),...Object.values(n)])}import g from'react';import{step as v,createNode as x,clearNode as h,is as b,createEvent as $,createStore as S,launch as j,scopeBind as M}from'effector/effector.mjs';let A='undefined'!=typeof window?g.useLayoutEffect:g.useEffect,w=e=>{throw Error(e)};const E=(e,t)=>t?t.getState(e):e.getState(),L=(e,t)=>e!==t,N=()=>g.useReducer((e=>e+1),0)[1],O=g.createContext(null);let{Provider:R}=O;export{R as Provider,p as connect,c as createComponent,i as createContextComponent,s as createGate,f as createReactState,l as createStoreConsumer,k as useEvent,a as useGate,m as useList,d as useStore,y as useStoreMap};
//# sourceMappingURL=ssr.mjs.map
